<!DOCTYPE html>
<html>
    <head>
        <title>print</title>
        <meta charset="utf-8">
        <style media="print">
            @page {
                size: auto;
                margin: 0mm;
            }
        </style>
    </head>
    <body>
        <!--<div style="width:300px; height:300px;border: 1px solid blue;"> <label>label</label> <button>button</button> </div> -->
        <div id="printerea" style="text-align: center;">
            试一下打印试一下打印试一下打印试一下打印试一下打印试一下打印试一下打印<br />
            试一下打印试一下打印试一下打印试一下打印试一下打印试一下打印试一下打印<br />
        </div>
        <button onclick='print_page(this)' id="printer" class="printer" style="visibility: visible;">print</button>
    </body>
    <script type="text/javascript" src="js/jquery-3.2.1.js"></script>
    <script type="text/javascript">
        function print_page(obj) {
            if(!!window.ActiveXObject || "ActiveXObject" in window) {
                remove_ie_header_and_footer();
                /*$('.printer').style.hidden='hidden'*/
            }
            //alert($('.printer').html())
            obj.style.visibility='hidden'
            //document.body.innerHTML=$('#printerea').html();
            window.print();
        };
        function remove_ie_header_and_footer() {
            var hkey_root, hkey_path, hkey_key;
            hkey_path = "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\PageSetup\\";
            try {
                var RegWsh = new ActiveXObject("WScript.Shell");
                RegWsh.RegWrite(hkey_path + "header", "");
                RegWsh.RegWrite(hkey_path + "footer", "");
            } catch(e) {}
        }
    </script>
</html>
